---
layout: post
title: "2020년 1월 5일 개발 로그"
---

간단하게 구글 차트를 통하여 히스토그램을 표현할 수 있도록 하였다.
다만, 이미지의 크기기 큰 경우, 성능에 문제가 있어 보인다.
따라서, 자바스크립트를 이용해서 프로그램을 만들 때는 웹 워커를 이용하거나 혹은 이미지 사이즈를 극단적으로 줄여야 할 것 같다.

OPENCV C/C++ 의 HIGHGUI 를 이용하여 그래프를 그릴 수 있는 것을 알아볼 필요도 있다.
OPENGL 을 이용한 차트 라이브러리를 만들거나 혹은 찾아볼 필요가 있겠다.

__INPUT__

<img width="200" id="input" src="/assets/images/first.jpg">

__OUTPUT__

<div id="chart_div" style="width: 500px; height: 500px;"></div>

---

<script type="text/javascript">
  function create_histogram() {
    let input = cv.imread('input');
    cv.cvtColor(input, input, cv.COLOR_RGBA2GRAY);
    let output = new Array(input.rows * input.cols + 1);
    for(let i = 0; i< input.rows * input.cols + 1; i++)
    {
      output[i] = [i, 0];
    }
    for(let y = 0; y < input.rows; y++) {
      for(let x = 0; x < input.cols; x++) {
        output[y * input.cols + x + 1][0] = (y * input.cols + x + 1) + '';
        output[y * input.cols + x + 1][1] = input.ucharAt(y, x);
      }
    }
    output[0] = ['coordinate', 'y'];

    google.charts.load("current", {packages:["corechart"]});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
      var data = google.visualization.arrayToDataTable(output);

      var options = {
        title: 'GRAY SCALE HISTOGRAM',
        legend: { position: 'none' },
        colors: ['#4285F4'],

        chartArea: { width: 400 },
        hAxis: {
          ticks: [0, 32, 64, 96, 128, 160, 192, 224, 256]
        },
        bar: { gap: 0 },

        histogram: {
          bucketSize: 1,
          maxNumBuckets: 600,
          minValue: 0,
          maxValue: 256
        }
      };

      var chart = new google.visualization.Histogram(document.getElementById('chart_div'));
      chart.draw(data, options);
    }
    input.delete();

  }

  dispatch(create_histogram);
</script>
